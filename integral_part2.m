syms ys(q) yp(q)
%q = 0.2
p = linspace(1,11,20)
%M = [62.8408222897883,21.8247346228469,10.0686782386033,5.61716788904753,3.64879982596269,2.09805602101544]
%M = [2.87924106737994e-06,1.99581596123450e-06,1.44252003672776e-06,1.06858979738974e-06,8.64258046504965e-07,6.45305540946897e-07,5.72795854814439e-07,4.50953236410523e-07,3.07101583534719e-07,2.68561194414266e-07,2.41493501354849e-07,2.11473830884446e-07,1.78738029201407e-07,1.29143899883143e-07,1.57232539211071e-07,9.64682255690518e-08,9.92423878654694e-08,9.34602320892135e-08,1.03184641845124e-07,6.58205755566918e-08]
M = [27679.8872734376,18925.4283786752,14899.5229513313,10325.7613064218,8916.49961307864,6737.85023891545,5282.78271128358,4404.08573256040,3488.35970198599,2387.72913705116,2387.93162978469,2252.83700286213,1946.21433752882,1554.35916086054,1255.17588870254,1244.38048513075,1331.53073490913,1135.70781277487,827.455377535437,798.116306808981]
ys(q) = (2*(acot(q) + q*log(1 + 1/q^2)))/(q + 4*q^3)
yp(q) = ((2*sqrt(1 - 4*q^2)*(1 + 24*q^2 + 16*q^4))/(4*(q + 4*q^3)^2)-(2*(2 + q^2)*(-1 + sqrt(1 - 4*q^2)))/(4*q^2*(1 + q^2)))
fplot(ys*330,[0.04,0.44])
hold on
fplot(yp*100,[0.04,0.44])
plot(p/25,M)
hold off
legend({'Approximate Model - Exact', 'Approximate Model - Piecewise','SimRIS'},'Location','north')
ylim([0 inf])
grid on
xlabel('q') 
ylabel('P_{RIS}^{Av}')
print -depsc pow_vs_q_all
matlab2tikz('Fig4.tex');